# Coinbase Developer Platform Wallet Secret

## Overview

The **Coinbase Developer Platform (CDP) Wallet Secret** is used for authenticating server-to-server requests with the CDP Server Wallet API (v2). It is **NOT** a standard Ethereum private key and cannot be used directly with Hardhat or other Ethereum tooling.

## What is the Wallet Secret?

The Wallet Secret is:
- An asymmetric key pair (ECDSA with secp256r1 curve) used for API authentication
- Generated by CDP's Trusted Execution Environment (TEE)
- Used to authenticate requests to the v2 Server Wallet API
- Required for sensitive wallet operations (POST/DELETE requests)
- Used in the `X-Wallet-Auth` header for API requests

## Current Configuration

Your CDP credentials have been stored in `.env.local`:

**Wallet Secret:**
```
COINBASE_WALLET_SECRET=MIGHAgEAMBMGByqGSM49AgEGCCqGSM49AwEHBG0wawIBAQQgWSuMcSoYVWJoNY58XdyfCNZ5CGPuOb5kJ2VutRBsO3WhRANCAAQYcvfamqIllerCOQAUXYmgeIkRfXci0BhqZhrTPLBM8cC7pJeWQU/GRD/rs8y2BoaAy9QZPm939PEohF2ZGRUP
```

**CDP API Key:**
```
CDP_API_KEY_NAME=f0ce8f6b-77bc-44c5-a4e2-9b6ca84c85b3
CDP_API_PRIVATE_KEY=a03ueYgPmO5EXWE5aHwWdREkX+vjdCLV/PtDhUpa7wkgc3H0W2vG2at4Eq8hIVtKAaPbmn3faUBMDVgyNYbYAA==
```

✅ **All CDP Server Wallet API credentials are now configured!**

## Usage

### For CDP Server Wallet API (v2)

The Wallet Secret is used with the CDP SDK or REST API to:
- Create and manage wallets programmatically
- Sign transactions through the TEE
- Deploy smart contracts via CDP SDK
- Execute token swaps and other onchain operations

Example with CDP SDK:
```typescript
import { Cdp } from "@coinbase/coinbase-sdk";

// Configure with Wallet Secret
const cdp = new Cdp({
  apiKeyName: process.env.CDP_API_KEY_NAME,
  apiKeyPrivate: process.env.CDP_API_PRIVATE_KEY,
  walletSecret: process.env.COINBASE_WALLET_SECRET,
});
```

### For Hardhat Deployment

**Important:** The Wallet Secret cannot be used directly with Hardhat. For Hardhat deployment, you need a **standard Ethereum private key** (64 hex characters starting with `0x`).

You have two options:

1. **Use a separate deployer wallet** (Recommended for initial deployment):
   - Create a new Ethereum wallet
   - Export its private key
   - Set it as `PRIVATE_KEY` in `.env.local`
   - Fund it with ETH on Base Mainnet
   - Use it for Hardhat deployment

2. **Use CDP SDK for deployment** (Alternative):
   - Use the CDP SDK with your Wallet Secret
   - Deploy contracts through the CDP Server Wallet API
   - This requires converting your contracts to the Solidity input JSON format

## Security Best Practices

1. **Never commit the Wallet Secret to git** - It's already in `.gitignore`
2. **Store securely** - Use environment variables or secure storage (AWS Secrets Manager, etc.)
3. **Rotate if compromised** - Generate a new secret in the CDP Portal if you suspect compromise
4. **Use IP allowlisting** - Restrict API key access to your infrastructure IPs
5. **Enable 2FA** - Protect your CDP account with two-factor authentication

## Environment Variables

### Required for CDP Server Wallet API:
- `COINBASE_WALLET_SECRET` - Your Wallet Secret ✅ (configured)
- `CDP_API_KEY_NAME` - Your CDP API Key Name ✅ (configured)
- `CDP_API_PRIVATE_KEY` - Your CDP API Private Key ✅ (configured)

### Required for Hardhat Deployment:
- `PRIVATE_KEY` - Standard Ethereum private key (0x...)
- `BASE_RPC_URL` - Base Mainnet RPC endpoint
- `BASESCAN_API_KEY` - BaseScan API key for verification

## Next Steps

1. **For Hardhat deployment:** Set up a separate `PRIVATE_KEY` in `.env.local`
2. **For CDP SDK usage:** The Wallet Secret is ready to use with the CDP SDK
3. **For automation scripts:** Consider migrating to CDP SDK for better security

## References

- [CDP Wallet Secret Documentation](https://docs.cdp.coinbase.com/server-wallets/v2/introduction/security)
- [CDP Server Wallet v2 API](https://docs.cdp.coinbase.com/server-wallets/v2/introduction/welcome)
- [CDP SDK Documentation](https://docs.cdp.coinbase.com/server-wallets/v2/introduction/welcome)

